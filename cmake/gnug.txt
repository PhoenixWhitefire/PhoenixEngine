# settings formatted for G++

set(PHX_TRACY_LIB_PATH Vendor/tracy/${PHX_BUILD_TYPE}/TracyClient)

target_compile_options(PhoenixEngine PRIVATE $<$<CONFIG:ReleaseTSan>:-O2>)
target_compile_options(PhoenixEngine PRIVATE $<$<CONFIG:Release>:-O2>)
target_compile_options(PhoenixEngine PRIVATE $<$<CONFIG:Debug>:-O0>)
target_compile_options(PhoenixEngine PRIVATE $<$<CONFIG:Debug>:-g3>)
target_compile_options(PhoenixEngine PRIVATE -MP)

# https://stackoverflow.com/a/9862800
target_compile_options(PhoenixEngine PRIVATE
	-pedantic -Wall -Wextra -Wcast-align
	-Wcast-qual -Wdisabled-optimization
	-Wformat=2 -Winit-self -Wlogical-op -Wmissing-declarations
	-Wmissing-include-dirs -Woverloaded-virtual
	-Wshadow -Wsign-promo
	-Wstrict-null-sentinel -Wstrict-overflow=2 -Wswitch-default
	-Wundef -Werror
	-Wno-shadow -Wstrict-aliasing=3 -Wno-missing-field-initializers
	-Wno-maybe-uninitialized -Wno-unused-parameter
	-Wno-sign-compare
	-Wuninitialized
	-Wno-format-truncation
)

target_compile_options(PhoenixEngine PRIVATE $<$<CONFIG:ReleaseTSan>:-fsanitize=thread>)
target_compile_options(PhoenixEngine PRIVATE $<$<CONFIG:DebugTSan>:-fsanitize=thread>)
target_compile_options(PhoenixEngine PRIVATE $<$<CONFIG:Debug>:-fsanitize=address,undefined>)

target_link_options(PhoenixEngine PRIVATE $<$<CONFIG:ReleaseTSan>:-flto -fsanitize=thread>)
target_link_options(PhoenixEngine PRIVATE $<$<CONFIG:DebugTSan>:-fsanitize=thread>)
target_link_options(PhoenixEngine PRIVATE $<$<CONFIG:Release>:-flto>)
target_link_options(PhoenixEngine PRIVATE $<$<CONFIG:Debug>:-fsanitize=address,undefined>)

target_link_libraries(PhoenixEngine PRIVATE stdc++)

add_compile_options($<$<CONFIG:ReleaseTSan>:-O2>)
add_compile_options($<$<CONFIG:DebugTSan>:-g3>)
add_compile_options($<$<CONFIG:Release>:-O2>)
add_compile_options($<$<CONFIG:Debug>:-fsanitize=address,undefined>)
add_compile_options($<$<CONFIG:Debug>:-O0>)
add_compile_options($<$<CONFIG:Debug>:-g3>)

add_compile_options(-MP)

add_link_options($<$<CONFIG:ReleaseTSan>:-fsanitize=thread>)
add_link_options($<$<CONFIG:ReleaseTSan>:-flto>)
add_link_options($<$<CONFIG:DebugTSan>:-fsanitize=thread>)
add_link_options($<$<CONFIG:Release>:-flto>)
add_link_options($<$<CONFIG:Debug>:-fsanitize=address,undefined>)
